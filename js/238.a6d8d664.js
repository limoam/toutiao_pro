"use strict";(self["webpackChunktoutiao_m"]=self["webpackChunktoutiao_m"]||[]).push([[238],{238:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-container"},[s("van-nav-bar",{staticClass:"page-nav-bar",attrs:{"left-arrow":"",border:!1},on:{"click-left":t.onClickLeft},scopedSlots:t._u([{key:"title",fn:function(){return[s("van-search",{directives:[{name:"fofo",rawName:"v-fofo"}],attrs:{placeholder:"请输入搜索关键词"},on:{input:t.searchFn,search:t.searchVal},model:{value:t.value,callback:function(e){t.value="string"===typeof e?e.trim():e},expression:"value"}})]},proxy:!0}])}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"sugg-list"},t._l(t.suggestList,(function(e,a){return s("div",{key:a,staticClass:"sugg-item",domProps:{innerHTML:t._s(t.lightFn(e,t.value))},on:{click:function(s){return t.searchSuggest(e)}}})})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.value&&t.history.length,expression:"!value && history.length"}],staticClass:"search-history"},[s("van-cell",{attrs:{title:"搜索历史"},scopedSlots:t._u([{key:"right-icon",fn:function(){return[s("van-icon",{staticClass:"search-icon",attrs:{name:"delete"},on:{click:t.clearHistory}})]},proxy:!0}])}),s("van-grid",{attrs:{"column-num":3,gutter:15,direction:"horizontal",border:!1}},t._l(t.history,(function(e,a){return s("van-grid-item",{key:a,attrs:{text:e},on:{click:function(s){return t.searchHistory(e)}}})})),1)],1)],1)},r=[],i=s(2705),n={name:"SearchIndex",methods:{onClickLeft(){this.$router.replace("/home")},searchFn(){clearTimeout(this.timer),this.value.length<=0?this.suggestList=[]:this.timer=setTimeout((async()=>{const{data:t}=await(0,i.D)(this.value);this.suggestList=t.data.options}),500)},lightFn(t,e){try{const s=new RegExp(e,"ig");return t.replace(s,(t=>`<span style="color: tomato;">${t}</span>`))}catch(s){}},gotoFn(t){this.$nextTick((function(){this.$router.push({name:"searchResult",params:{value:t}})}))},searchVal(){this.value&&(this.history.push(this.value),this.gotoFn(this.value))},searchSuggest(t){t&&(this.history.push(t),this.gotoFn(t))},searchHistory(t){this.gotoFn(t)},clearHistory(){this.history=[],this.$toast("历史记录已清除")}},data(){return{value:"",timer:null,suggestList:[],history:JSON.parse(localStorage.getItem("hist"))||[]}},watch:{history:{deep:!0,handler(t){const e=new Set(t),s=Array.from(e);localStorage.setItem("hist",JSON.stringify(s))}}}},o=n,c=s(1001),l=(0,c.Z)(o,a,r,!1,null,"0c757300",null),u=l.exports},2705:function(t,e,s){s.d(e,{D:function(){return r},n:function(){return i}});var a=s(5972);const r=t=>a.Z.get("/v1_0/suggestion",{params:{q:t}}),i=({page:t=1,q:e})=>a.Z.get("/v1_0/search",{params:{page:t,per_page:10,q:e}})}}]);
//# sourceMappingURL=238.a6d8d664.js.map