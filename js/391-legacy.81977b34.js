(self["webpackChunktoutiao_m"]=self["webpackChunktoutiao_m"]||[]).push([[391],{2391:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return b}});var r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"article-detail"},[e("van-nav-bar",{staticClass:"page-nav-bar",attrs:{fixed:"",title:"文章详情","left-arrow":"",border:!1},on:{"click-left":function(n){return t.$router.back()}}}),e("div",{staticClass:"article-container"},[e("h1",{staticClass:"art-title"},[t._v(t._s(t.artObj.title))]),e("van-cell",{attrs:{center:"",title:t.artObj.aut_name,label:t._f("relativeTime")(t.artObj.pubdate)},scopedSlots:t._u([{key:"icon",fn:function(){return[e("img",{staticClass:"avatar",attrs:{src:t.artObj.aut_photo,alt:""}})]},proxy:!0},{key:"default",fn:function(){return[e("div",[t.artObj.is_followed?e("van-button",{attrs:{type:"info",size:"mini"},on:{click:function(n){return t.followFn(!1)}}},[t._v("已关注")]):e("van-button",{attrs:{icon:"plus",type:"info",size:"mini",plain:""},on:{click:function(n){return t.followFn(!0)}}},[t._v("关注")])],1)]},proxy:!0}])}),e("van-divider"),e("div",{staticClass:"art-content",domProps:{innerHTML:t._s(t.artObj.content)}}),e("van-divider",[t._v("End")]),e("div",{staticClass:"like-box"},[1===t.artObj.attitude?e("van-button",{attrs:{icon:"good-job",type:"danger",size:"small"},on:{click:function(n){return t.attitudeFn(0)}}},[t._v("已点赞")]):e("van-button",{attrs:{icon:"good-job-o",type:"danger",plain:"",size:"small"},on:{click:function(n){return t.attitudeFn(1)}}},[t._v("点赞")])],1)],1),e("div",[e("CommentList")],1)],1)},a=[],i=e(6198),o=(e(8975),e(4234)),c=e(6165),s=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("div",{staticClass:"cmt-list"},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多评论了，请发表评论","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(n){t.loading=n},expression:"loading"}},t._l(t.commentArr,(function(n){return e("div",{key:n.com_id,staticClass:"cmt-item"},[e("div",{staticClass:"cmt-header"},[e("div",{staticClass:"cmt-header-left"},[e("img",{staticClass:"avatar",attrs:{src:n.aut_photo}}),e("span",{staticClass:"uname"},[t._v(t._s(n.aut_name))])]),e("div",{staticClass:"cmt-header-right"},[n.is_liking?e("van-icon",{attrs:{name:"like",size:"16",color:"red"},on:{click:function(e){return t.islove(n,!1)}}}):e("van-icon",{attrs:{name:"like-o",size:"16",color:"gray"},on:{click:function(e){return t.islove(n,!0)}}})],1)]),e("div",{staticClass:"cmt-body",domProps:{innerHTML:t._s(n.content)}}),e("div",{staticClass:"cmt-footer"},[t._v(t._s(t._f("relativeTime")(n.pubdate)))])])})),0)],1),t.isShowCmtIpt?e("div",{staticClass:"cmt-box van-hairline--top"},[e("textarea",{directives:[{name:"fofo",rawName:"v-fofo"},{name:"model",rawName:"v-model.trim",value:t.comText,expression:"comText",modifiers:{trim:!0}}],attrs:{placeholder:"友善评论、理性发言、阳光心灵"},domProps:{value:t.comText},on:{blur:[t.blurFn,function(n){return t.$forceUpdate()}],input:function(n){n.target.composing||(t.comText=n.target.value.trim())}}}),e("van-button",{attrs:{type:"default",disabled:0===t.comText.length},on:{click:t.sendFn}},[t._v("发布")])],1):e("div",{staticClass:"add-cmt-box van-hairline--top"},[e("van-icon",{attrs:{name:"arrow-left",size:"0.48rem"},on:{click:function(n){return t.$router.back()}}}),e("div",{staticClass:"ipt-cmt-div",on:{click:t.toggleShowFn}},[t._v("发表评论")]),e("div",{staticClass:"icon-box"},[e("van-badge",{attrs:{content:0===t.total_count?"":t.total_count,max:"99"}},[e("van-icon",{attrs:{name:"comment-o",size:"0.53333334rem"},on:{click:t.commentFn}})],1),e("van-icon",{attrs:{name:"star-o",size:"0.53333334rem"}}),e("van-icon",{attrs:{name:"share-o",size:"0.53333334rem"}})],1)],1)])},u=[],l=e(4479),d=(e(2222),{name:"CommentList",data:function(){return{offset:null,commentArr:[],isShowCmtIpt:!1,total_count:0,comText:"",loading:!1,finished:!1,lastId:""}},created:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){var e,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,o.jS)({id:t.$route.query.art_id});case 2:e=n.sent,r=e.data,t.commentArr=r.data.results,t.total_count=r.data.total_count,t.lastId=r.data.last_id,0===r.data.results.length&&(t.finished=!0);case 8:case"end":return n.stop()}}),n)})))()},methods:{islove:function(t,n){return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.is_liking=n,!n){e.next=6;break}return e.next=4,(0,o.wR)(t.com_id);case 4:e.next=8;break;case 6:return e.next=8,(0,o.ih)(t.com_id);case 8:case"end":return e.stop()}}),e)})))()},toggleShowFn:function(){this.isShowCmtIpt=!this.isShowCmtIpt},commentFn:function(){document.querySelector(".like-box").scrollIntoView({behavior:"smooth"})},sendFn:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){var e,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,o.IJ)({id:t.$route.query.art_id,content:t.comText});case 2:e=n.sent,r=e.data,t.total_count++,t.commentArr.unshift(r.data.new_obj),t.comText="",t.commentFn();case 8:case"end":return n.stop()}}),n)})))()},blurFn:function(){var t=this;setTimeout((function(){t.isShowCmtIpt=!1}),0)},onLoad:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){var e,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(t.commentArr.length>0)){n.next=12;break}return n.next=3,(0,o.jS)({id:t.$route.query.art_id,offset:t.lastId});case 3:e=n.sent,r=e.data,t.commentArr=[].concat((0,l.Z)(t.commentArr),(0,l.Z)(r.data.results)),t.total_count=r.data.total_count,t.lastId=r.data.last_id,t.loading=!1,null===r.data.last_id&&(t.finished=!0),n.next=13;break;case 12:t.loading=!1;case 13:case"end":return n.stop()}}),n)})))()}}}),f=d,m=e(1001),v=(0,m.Z)(f,s,u,!1,null,"a6c8cb3a",null),p=v.exports,_={name:"ArticleDetail",props:{art_id:{type:String,required:!0}},data:function(){return{artObj:{}}},created:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){var e,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,o.mx)(t.art_id);case 2:e=n.sent,r=e.data,t.artObj=r.data;case 5:case"end":return n.stop()}}),n)})))()},methods:{followFn:function(t){var n=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.artObj.is_followed=t,!t){e.next=6;break}return e.next=4,(0,c.P_)(n.artObj.aut_id);case 4:e.next=8;break;case 6:return e.next=8,(0,c.wQ)(n.artObj.aut_id);case 8:case"end":return e.stop()}}),e)})))()},attitudeFn:function(t){var n=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var r,a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.artObj.attitude=t,!t){e.next=9;break}return e.next=4,(0,o.HA)(n.artObj.art_id);case 4:r=e.sent,a=r.data,console.log(a),e.next=14;break;case 9:return e.next=11,(0,o.Id)(n.artObj.art_id);case 11:i=e.sent,c=i.data,console.log(c);case 14:case"end":return e.stop()}}),e)})))()}},components:{CommentList:p}},h=_,g=(0,m.Z)(h,r,a,!1,null,"6f01d320",null),b=g.exports},1038:function(t,n,e){var r=e(2109),a=e(8457),i=e(7072),o=!i((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:o},{from:a})},4234:function(t,n,e){"use strict";e.d(n,{HA:function(){return s},IJ:function(){return d},Id:function(){return u},X:function(){return o},Zz:function(){return a},ih:function(){return m},jS:function(){return l},mx:function(){return c},tH:function(){return i},wR:function(){return f}});var r=e(5972),a=function(t){return r.Z.get("/v1_0/articles",{params:t})},i=function(t){return r.Z.post("/v1_0/article/dislikes",{target:t})},o=function(t){return r.Z.post("/v1_0/article/reports",t)},c=function(t){return r.Z.get("/v1_0/articles/".concat(t))},s=function(t){return r.Z.post("/v1_0/article/likings",{target:t})},u=function(t){return r.Z["delete"]("/v1_0/article/likings/".concat(t))},l=function(t){var n=t.id,e=t.offset,a=void 0===e?null:e,i=t.limit,o=void 0===i?10:i;return r.Z.get("/v1_0/comments",{params:{type:"a",source:n,offset:a,limit:o}})},d=function(t){var n=t.id,e=t.content,a=t.artId,i=void 0===a?null:a,o={target:n,content:e,art_id:i};return i||(o.art_id=i),r.Z.post("/v1_0/comments",o)},f=function(t){return r.Z.post("/v1_0/comment/likings",{target:t})},m=function(t){return r.Z["delete"]("/v1_0/comment/likings/".concat(t))}},6165:function(t,n,e){"use strict";e.d(n,{CA:function(){return d},P_:function(){return s},Q6:function(){return i},XN:function(){return f},bG:function(){return o},nP:function(){return l},vh:function(){return c},wQ:function(){return u},x4:function(){return a}});var r=e(5972),a=function(t){return r.Z.post("/v1_0/authorizations",t)},i=function(t){return r.Z.get("/v1_0/sms/codes/".concat(t))},o=function(){return r.Z.get("/v1_0/user")},c=function(){return r.Z.get("/v1_0/user/channels")},s=function(t){return r.Z.post("/v1_0/user/followings",{target:t})},u=function(t){return r.Z["delete"]("/v1_0/user/followings/".concat(t))},l=function(){return r.Z.get("/v1_0/user/profile")},d=function(t){return r.Z.patch("/v1_0/user/photo",t)},f=function(t){var n={name:"",gender:0,birthday:"",real_name:"",intro:""};for(var e in n)void 0===t[e]?delete n[e]:n[e]=t[e];return r.Z.patch("/v1_0/user/profile",n)}},4479:function(t,n,e){"use strict";function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function a(t){if(Array.isArray(t))return r(t)}e.d(n,{Z:function(){return s}});e(2526),e(1817),e(1539),e(2165),e(8783),e(3948),e(1038);function i(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}e(7042),e(8309),e(4916),e(7601);function o(t,n){if(t){if("string"===typeof t)return r(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}e(1703);function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return a(t)||i(t)||o(t)||c()}}}]);
//# sourceMappingURL=391-legacy.81977b34.js.map