{"version":3,"file":"js/793.874f53b5.js","mappings":"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","sources":["webpack://toutiao-m/./src/views/articleDetail/index.vue?a8ca","webpack://toutiao-m/./src/views/articleDetail/CommentList.vue?52d5","webpack://toutiao-m/src/views/articleDetail/CommentList.vue","webpack://toutiao-m/./src/views/articleDetail/CommentList.vue?b174","webpack://toutiao-m/./src/views/articleDetail/CommentList.vue","webpack://toutiao-m/src/views/articleDetail/index.vue","webpack://toutiao-m/./src/views/articleDetail/index.vue?98ad","webpack://toutiao-m/./src/views/articleDetail/index.vue","webpack://toutiao-m/./src/api/article.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"article-detail\"},[_c('van-nav-bar',{staticClass:\"page-nav-bar\",attrs:{\"fixed\":\"\",\"title\":\"文章详情\",\"left-arrow\":\"\",\"border\":false},on:{\"click-left\":function($event){return _vm.$router.back()}}}),(Object.keys(_vm.artObj).length !== 0)?_c('div',[_c('div',{staticClass:\"article-container\"},[_c('h1',{staticClass:\"art-title\"},[_vm._v(_vm._s(_vm.artObj.title))]),_c('van-cell',{attrs:{\"center\":\"\",\"title\":_vm.artObj.aut_name,\"label\":_vm._f(\"relativeTime\")(_vm.artObj.pubdate)},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.artObj.aut_photo,\"alt\":\"\"}})]},proxy:true},{key:\"default\",fn:function(){return [_c('div',[(_vm.artObj.is_followed)?_c('van-button',{attrs:{\"type\":\"info\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.followFn(false)}}},[_vm._v(\"已关注\")]):_c('van-button',{attrs:{\"icon\":\"plus\",\"type\":\"info\",\"size\":\"mini\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.followFn(true)}}},[_vm._v(\"关注\")])],1)]},proxy:true}],null,false,3681198566)}),_c('van-divider'),_c('div',{staticClass:\"art-content\",domProps:{\"innerHTML\":_vm._s(_vm.artObj.content)}}),_c('van-divider',[_vm._v(\"End\")]),_c('div',{staticClass:\"like-box\"},[(_vm.artObj.attitude === 1)?_c('van-button',{attrs:{\"icon\":\"good-job\",\"type\":\"danger\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.attitudeFn(0)}}},[_vm._v(\"已点赞\")]):_c('van-button',{attrs:{\"icon\":\"good-job-o\",\"type\":\"danger\",\"plain\":\"\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.attitudeFn(1)}}},[_vm._v(\"点赞\")])],1)],1),_c('div',[_c('CommentList')],1)]):_c('van-loading',{attrs:{\"type\":\"spinner\",\"color\":\"#1989fa\"}},[_vm._v(\"加载中. . .\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"cmt-list\"},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多评论了，请发表评论\",\"immediate-check\":false},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.commentArr),function(item){return _c('div',{key:item.com_id,staticClass:\"cmt-item\"},[_c('div',{staticClass:\"cmt-header\"},[_c('div',{staticClass:\"cmt-header-left\"},[_c('img',{staticClass:\"avatar\",attrs:{\"src\":item.aut_photo}}),_c('span',{staticClass:\"uname\"},[_vm._v(_vm._s(item.aut_name))])]),_c('div',{staticClass:\"cmt-header-right\"},[(item.is_liking)?_c('van-icon',{attrs:{\"name\":\"like\",\"size\":\"16\",\"color\":\"red\"},on:{\"click\":function($event){return _vm.islove(item, false)}}}):_c('van-icon',{attrs:{\"name\":\"like-o\",\"size\":\"16\",\"color\":\"gray\"},on:{\"click\":function($event){return _vm.islove(item, true)}}})],1)]),_c('div',{staticClass:\"cmt-body\",domProps:{\"innerHTML\":_vm._s(item.content)}}),_c('div',{staticClass:\"cmt-footer\"},[_vm._v(_vm._s(_vm._f(\"relativeTime\")(item.pubdate)))])])}),0)],1),(!_vm.isShowCmtIpt)?_c('div',{staticClass:\"add-cmt-box van-hairline--top\"},[_c('van-icon',{attrs:{\"name\":\"arrow-left\",\"size\":\"0.48rem\"},on:{\"click\":function($event){return _vm.$router.back()}}}),_c('div',{staticClass:\"ipt-cmt-div\",on:{\"click\":_vm.toggleShowFn}},[_vm._v(\"发表评论\")]),_c('div',{staticClass:\"icon-box\"},[_c('van-badge',{attrs:{\"content\":_vm.total_count === 0 ? '' : _vm.total_count,\"max\":\"99\"}},[_c('van-icon',{attrs:{\"name\":\"comment-o\",\"size\":\"0.53333334rem\"},on:{\"click\":_vm.commentFn}})],1),_c('van-icon',{attrs:{\"name\":\"star-o\",\"size\":\"0.53333334rem\"}}),_c('van-icon',{attrs:{\"name\":\"share-o\",\"size\":\"0.53333334rem\"}})],1)],1):_c('div',{staticClass:\"cmt-box van-hairline--top\"},[_c('textarea',{directives:[{name:\"fofo\",rawName:\"v-fofo\"},{name:\"model\",rawName:\"v-model.trim\",value:(_vm.comText),expression:\"comText\",modifiers:{\"trim\":true}}],attrs:{\"placeholder\":\"友善评论、理性发言、阳光心灵\"},domProps:{\"value\":(_vm.comText)},on:{\"blur\":[_vm.blurFn,function($event){return _vm.$forceUpdate()}],\"input\":function($event){if($event.target.composing){ return; }_vm.comText=$event.target.value.trim()}}}),_c('van-button',{attrs:{\"type\":\"default\",\"disabled\":_vm.comText.length === 0 ? true : false},on:{\"click\":_vm.sendFn}},[_vm._v(\"发布\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <!-- 评论列表 -->\r\n    <div class=\"cmt-list\">\r\n      <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"没有更多评论了，请发表评论\" @load=\"onLoad\" :immediate-check=\"false\">\r\n        <!-- 评论的 Item 项 -->\r\n        <div class=\"cmt-item\" v-for=\"item in commentArr\" :key=\"item.com_id\">\r\n          <!-- 头部区域 -->\r\n          <div class=\"cmt-header\">\r\n            <!-- 头部左侧 -->\r\n            <div class=\"cmt-header-left\">\r\n              <img :src=\"item.aut_photo\" class=\"avatar\" />\r\n              <span class=\"uname\">{{ item.aut_name }}</span>\r\n            </div>\r\n            <!-- 头部右侧 -->\r\n            <div class=\"cmt-header-right\">\r\n              <van-icon name=\"like\" size=\"16\" color=\"red\" v-if=\"item.is_liking\" @click=\"islove(item, false)\" />\r\n              <van-icon name=\"like-o\" size=\"16\" color=\"gray\" v-else @click=\"islove(item, true)\" />\r\n            </div>\r\n          </div>\r\n          <!-- 主体区域 -->\r\n          <div class=\"cmt-body\" v-html=\"item.content\"></div>\r\n          <!-- 尾部区域 -->\r\n          <div class=\"cmt-footer\">{{ item.pubdate | relativeTime }}</div>\r\n        </div>\r\n      </van-list>\r\n    </div>\r\n    <!-- 底部添加评论区域 - 1 -->\r\n    <div class=\"add-cmt-box van-hairline--top\" v-if=\"!isShowCmtIpt\">\r\n      <van-icon name=\"arrow-left\" size=\"0.48rem\" @click=\"$router.back()\" />\r\n      <div class=\"ipt-cmt-div\" @click=\"toggleShowFn\">发表评论</div>\r\n      <div class=\"icon-box\">\r\n        <van-badge :content=\"total_count === 0 ? '' : total_count\" max=\"99\">\r\n          <van-icon name=\"comment-o\" size=\"0.53333334rem\" @click=\"commentFn\" />\r\n        </van-badge>\r\n        <van-icon name=\"star-o\" size=\"0.53333334rem\" />\r\n        <van-icon name=\"share-o\" size=\"0.53333334rem\" />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 底部添加评论区域 - 2 -->\r\n    <div class=\"cmt-box van-hairline--top\" v-else>\r\n      <textarea placeholder=\"友善评论、理性发言、阳光心灵\" v-fofo @blur=\"blurFn\" v-model.trim=\"comText\"></textarea>\r\n      <van-button type=\"default\" :disabled=\"comText.length === 0 ? true : false\" @click=\"sendFn\">发布</van-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { commentsList, likeComments, disLikeComments, commentsAdd } from '@/api/article'\r\nexport default {\r\n  name: 'CommentList',\r\n  data() {\r\n    return {\r\n      offset: null, // 偏移量评论id\r\n      commentArr: [],\r\n      isShowCmtIpt: false,\r\n      total_count: 0, // 评论数量\r\n      comText: '', // 发布评论\r\n      loading: false,\r\n      finished: false,\r\n      lastId: ''\r\n    }\r\n  },\r\n  async created() {\r\n    const { data: res } = await commentsList({\r\n      id: this.$route.query.art_id // 文章id\r\n    })\r\n    this.commentArr = res.data.results\r\n    this.total_count = res.data.total_count\r\n    this.lastId = res.data.last_id // 分页\r\n    if (res.data.results.length === 0) {\r\n      this.finished = true\r\n    }\r\n    // console.log(res)\r\n    /* console.log(this.$route.query)\r\n    console.log(this) */\r\n  },\r\n  methods: {\r\n    // 评论点赞\r\n    async islove(val, bool) {\r\n      val.is_liking = bool\r\n      if (bool) {\r\n        await likeComments(val.com_id)\r\n      } else {\r\n        await disLikeComments(val.com_id)\r\n      }\r\n    },\r\n    // 评论\r\n    toggleShowFn() {\r\n      this.isShowCmtIpt = !this.isShowCmtIpt\r\n    },\r\n    // 评论消息点击事件\r\n    commentFn() {\r\n      // window.scrollTo(o,xx)\r\n      // js代码是在html css运行后真实dom已经在，从document获取整个网页的标签\r\n      // window.scrollTo使网页进行滚动，如果底下没内容则停止滚动\r\n      /* const height = document.querySelector('.article-container').scrollHeight\r\n      console.log(height)\r\n      window.scrollTo(0, height) */\r\n      // 动画实现\r\n      // 既能滚动又能带动画原生方法，不选择评论因为头部导航会被挡住\r\n      // (有的电脑不支持)\r\n      document.querySelector('.like-box').scrollIntoView({\r\n        behavior: 'smooth'\r\n      })\r\n    },\r\n    // 发布按钮\r\n    async sendFn() {\r\n      // 把评论加入到列表里\r\n      const { data: res } = await commentsAdd({\r\n        id: this.$route.query.art_id,\r\n        content: this.comText\r\n      })\r\n      // console.log(res)\r\n      this.total_count++\r\n      this.commentArr.unshift(res.data.new_obj)\r\n      this.comText = ''\r\n      this.commentFn()\r\n    },\r\n    // 失去焦点\r\n    blurFn() {\r\n      // 点击发布按钮不执行，原因是评论容器2在点击发布时输入框失去焦点，整个dom移除，点击事件未来得及执行\r\n      setTimeout(() => {\r\n        this.isShowCmtIpt = false\r\n      }, 0)\r\n    },\r\n    // 加载更多\r\n    async onLoad() {\r\n      // 这个判断和immediate-check功能一样,双重保险，不然屏幕滚动就会导致触发\r\n      if (this.commentArr.length > 0) {\r\n        const { data: res } = await commentsList({\r\n          id: this.$route.query.art_id,\r\n          offset: this.lastId\r\n        })\r\n        // console.log(res)\r\n        this.commentArr = [...this.commentArr, ...res.data.results]\r\n        this.total_count = res.data.total_count // 总数量\r\n        this.lastId = res.data.last_id\r\n        this.loading = false\r\n        if (res.data.last_id === null) {\r\n          this.finished = true\r\n        }\r\n      } else {\r\n        // 如果没有immediate-check，这个得让加载中变为false\r\n        this.loading = false\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.cmt-list {\r\n  padding: 20px;\r\n  background-color: #fff;\r\n  .cmt-item {\r\n    padding: 30px 0;\r\n    .cmt-item {\r\n      border-top: 1px solid #f8f8f8;\r\n    }\r\n    .cmt-header {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      .cmt-header-left {\r\n        display: flex;\r\n        align-items: center;\r\n        .avatar {\r\n          width: 80px;\r\n          height: 80px;\r\n          background-color: #f8f8f8;\r\n          border-radius: 50%;\r\n          margin-right: 30px;\r\n        }\r\n        .uname {\r\n          font-size: 24px;\r\n        }\r\n      }\r\n    }\r\n    .cmt-body {\r\n      font-size: 28px;\r\n      line-height: 56px;\r\n      text-indent: 2em;\r\n      margin-top: 12px;\r\n      word-break: break-all;\r\n    }\r\n    .cmt-footer {\r\n      font-size: 24px;\r\n      color: gray;\r\n      margin-top: 20px;\r\n    }\r\n  }\r\n}\r\n/*美化 - 文章详情 - 底部的评论页面 */\r\n// 外层容器\r\n.art-cmt-container-1 {\r\n  padding-bottom: 92px;\r\n}\r\n.art-cmt-container-2 {\r\n  padding-bottom: 160px;\r\n}\r\n\r\n// 发布评论的盒子 - 1\r\n.add-cmt-box {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  background-color: white;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  height: 92px;\r\n  line-height: 92px;\r\n  padding-left: 20px;\r\n  .ipt-cmt-div {\r\n    flex: 1;\r\n    border: 2px solid #efefef;\r\n    border-radius: 30px;\r\n    height: 60px;\r\n    font-size: 24px;\r\n    line-height: 60px;\r\n    padding-left: 30px;\r\n    margin-left: 20px;\r\n    background-color: #f8f8f8;\r\n  }\r\n  .icon-box {\r\n    width: 40%;\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n    line-height: 0;\r\n  }\r\n}\r\n\r\n.child {\r\n  width: 40px;\r\n  height: 40px;\r\n  background: #f2f3f5;\r\n}\r\n\r\n// 发布评论的盒子 - 2\r\n.cmt-box {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 160px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-size: 24px;\r\n  padding-left: 20px;\r\n  box-sizing: border-box;\r\n  background-color: white;\r\n  textarea {\r\n    flex: 1;\r\n    height: 66%;\r\n    border: 2px solid #efefef;\r\n    background-color: #f8f8f8;\r\n    resize: none;\r\n    border-radius: 12px;\r\n    padding: 10px;\r\n  }\r\n  .van-button {\r\n    height: 100%;\r\n    border: none;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommentList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommentList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CommentList.vue?vue&type=template&id=a6c8cb3a&scoped=true&\"\nimport script from \"./CommentList.vue?vue&type=script&lang=js&\"\nexport * from \"./CommentList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CommentList.vue?vue&type=style&index=0&id=a6c8cb3a&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a6c8cb3a\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"article-detail\">\r\n    <!-- Header 区域 -->\r\n    <van-nav-bar fixed title=\"文章详情\" left-arrow @click-left=\"$router.back()\" class=\"page-nav-bar\" :border=\"false\" />\r\n    <!-- Object.keys(artObj).length 返回数组 -->\r\n    <div v-if=\"Object.keys(artObj).length !== 0\">\r\n      <!-- 文章信息区域 -->\r\n      <div class=\"article-container\">\r\n        <!-- 文章标题 -->\r\n        <h1 class=\"art-title\">{{ artObj.title }}</h1>\r\n\r\n        <!-- 用户信息 -->\r\n        <van-cell center :title=\"artObj.aut_name\" :label=\"artObj.pubdate | relativeTime\">\r\n          <template #icon>\r\n            <img :src=\"artObj.aut_photo\" alt=\"\" class=\"avatar\" />\r\n          </template>\r\n          <template #default>\r\n            <div>\r\n              <van-button type=\"info\" size=\"mini\" v-if=\"artObj.is_followed\" @click=\"followFn(false)\">已关注</van-button>\r\n              <van-button icon=\"plus\" type=\"info\" size=\"mini\" plain v-else @click=\"followFn(true)\">关注</van-button>\r\n            </div>\r\n          </template>\r\n        </van-cell>\r\n\r\n        <!-- 分割线 -->\r\n        <van-divider></van-divider>\r\n\r\n        <!-- 文章内容 -->\r\n        <div class=\"art-content\" v-html=\"artObj.content\"></div>\r\n        <!-- 分割线 -->\r\n        <van-divider>End</van-divider>\r\n        <!-- 点赞 -->\r\n        <!-- attitude 用户对文章的态度, -1: 无态度，0-不喜欢，1-点赞 -->\r\n        <div class=\"like-box\">\r\n          <van-button icon=\"good-job\" type=\"danger\" size=\"small\" v-if=\"artObj.attitude === 1\" @click=\"attitudeFn(0)\">已点赞</van-button>\r\n          <van-button icon=\"good-job-o\" type=\"danger\" plain size=\"small\" v-else @click=\"attitudeFn(1)\">点赞</van-button>\r\n        </div>\r\n      </div>\r\n      <!-- 文章评论 -->\r\n      <div>\r\n        <CommentList />\r\n      </div>\r\n    </div>\r\n    <van-loading type=\"spinner\" color=\"#1989fa\" v-else>加载中. . .</van-loading>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 文章详情 点赞或取消\r\nimport { articleDetail, likeArticle, disLikeArticle } from '@/api/article'\r\n// 关注用户\r\nimport { followUser, unFollowUser } from '@/api/user'\r\nimport CommentList from '@/views/articleDetail/CommentList'\r\nexport default {\r\n  name: 'ArticleDetail',\r\n  props: {\r\n    art_id: {\r\n      type: String,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      artObj: {}\r\n    }\r\n  },\r\n  // 获取详情\r\n  async created() {\r\n    // console.log(this.art_id)\r\n    const { data: res } = await articleDetail(this.art_id)\r\n    // console.log(res)\r\n    this.artObj = res.data\r\n  },\r\n  methods: {\r\n    // 关注或者不关注\r\n    async followFn(bool) {\r\n      // if(bool===true){\r\n      // 点击按钮关注或者不关注\r\n      this.artObj.is_followed = bool\r\n      // 页面进行变换\r\n      if (bool) {\r\n        // 掉接口关注\r\n        await followUser(this.artObj.aut_id)\r\n        // console.log(res)\r\n      } else {\r\n        await unFollowUser(this.artObj.aut_id)\r\n        // console.log(res)\r\n      }\r\n      // }\r\n    },\r\n    // 点赞取消点赞\r\n    async attitudeFn(num) {\r\n      this.artObj.attitude = num\r\n      if (num) {\r\n        // console.log(num)\r\n        const { data: res } = await likeArticle(this.artObj.art_id)\r\n        console.log(res)\r\n      } else {\r\n        const { data: res } = await disLikeArticle(this.artObj.art_id)\r\n        console.log(res)\r\n      }\r\n    }\r\n  },\r\n  components: { CommentList }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.article-detail {\r\n  padding: 98px 0;\r\n  .article-container {\r\n    position: relative;\r\n    padding: 20px;\r\n    background-color: #fff;\r\n    // height: 83vh;\r\n    overflow-y: auto;\r\n  }\r\n  .art-title {\r\n    font-size: 32px;\r\n    font-weight: bold;\r\n    margin: 20px 0;\r\n  }\r\n\r\n  .art-content {\r\n    font-size: 24px;\r\n    line-height: 48px;\r\n    width: 100%;\r\n    overflow-x: scroll;\r\n    word-break: break-all;\r\n    /deep/ img {\r\n      width: 100%;\r\n    }\r\n    /deep/ pre {\r\n      white-space: pre-wrap;\r\n      word-wrap: break-word;\r\n    }\r\n  }\r\n\r\n  .van-cell {\r\n    padding: 10px 0;\r\n    &::after {\r\n      display: none;\r\n    }\r\n  }\r\n\r\n  .avatar {\r\n    width: 120px;\r\n    height: 120px;\r\n    border-radius: 50%;\r\n    background-color: #f8f8f8;\r\n    margin-right: 10px;\r\n    border: none;\r\n  }\r\n\r\n  .like-box {\r\n    display: flex;\r\n    justify-content: center;\r\n  }\r\n  .van-loading {\r\n    text-align: center;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=0356879a&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=0356879a&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0356879a\",\n  null\n  \n)\n\nexport default component.exports","// 文章请求模块\r\nimport request from '@/utils/request'\r\n// 请求获取文章列表\r\nexport const getArticles = (params) => {\r\n  return request.get('/v1_0/articles', {\r\n    params\r\n  })\r\n}\r\n// 文章反馈-不感兴趣\r\nexport const UnlikeArticles = (target) => {\r\n  return request.post('/v1_0/article/dislikes', {\r\n    target\r\n  })\r\n}\r\n// 文章反馈-反馈\r\nexport const FeedbackArticles = (obj) => {\r\n  return request.post('/v1_0/article/reports', obj)\r\n}\r\n// 文章详情\r\nexport const articleDetail = (id) => {\r\n  return request.get(`/v1_0/articles/${id}`)\r\n}\r\n// 对文章点赞\r\nexport const likeArticle = (target) => {\r\n  return request.post('/v1_0/article/likings', { target })\r\n}\r\n// 对文章取消点赞\r\nexport const disLikeArticle = (target) => {\r\n  return request.delete(`/v1_0/article/likings/${target}`)\r\n}\r\n// 文章评论列表\r\nexport const commentsList = ({ id, offset = null, limit = 10 }) => {\r\n  return request.get('/v1_0/comments', {\r\n    params: {\r\n      // axios针对param参数，如果发现键值对的值为null，会忽略此参数名和值不携带\r\n      type: 'a',\r\n      source: id,\r\n      offset,\r\n      limit\r\n    }\r\n  })\r\n}\r\n// 发表评论\r\nexport const commentsAdd = ({ id, content, artId = null }) => {\r\n  // axios请求体传参如果值为null是不会忽略这个参数的也会把参数名和值携带给后台（只有params遇到null才会忽略）\r\n  // 形参是art_id可选参数，如果逻辑页面是对文章评论，则不需要传，所以这是，内部art_id值为null就证明此次调用是针对文章评论\r\n  const obj = {\r\n    target: id,\r\n    content,\r\n    art_id: artId\r\n  }\r\n  if (!artId) {\r\n    obj.art_id = artId\r\n  }\r\n  return request.post('/v1_0/comments', obj)\r\n}\r\n// 评论点赞\r\nexport const likeComments = (target) => {\r\n  return request.post('/v1_0/comment/likings', { target })\r\n}\r\n// 取消点赞\r\nexport const disLikeComments = (target) => {\r\n  return request.delete(`/v1_0/comment/likings/${target}`)\r\n}\r\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","back","Object","keys","artObj","length","_v","_s","title","aut_name","_f","pubdate","scopedSlots","_u","key","fn","aut_photo","proxy","followFn","domProps","content","attitude","attitudeFn","staticRenderFns","finished","onLoad","model","value","callback","$$v","loading","expression","_l","item","com_id","islove","isShowCmtIpt","directives","name","rawName","modifiers","blurFn","$forceUpdate","target","composing","comText","trim","sendFn","toggleShowFn","total_count","commentFn","data","offset","commentArr","lastId","id","methods","val","document","behavior","setTimeout","component","props","art_id","type","required","console","components","CommentList","getArticles","params","request","UnlikeArticles","FeedbackArticles","obj","articleDetail","likeArticle","disLikeArticle","commentsList","limit","source","commentsAdd","artId","likeComments","disLikeComments"],"sourceRoot":""}