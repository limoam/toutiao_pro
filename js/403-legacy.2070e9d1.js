"use strict";(self["webpackChunktoutiao_m"]=self["webpackChunktoutiao_m"]||[]).push([[403],{2403:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login-container"},[s("van-nav-bar",{staticClass:"page-nav-bar",attrs:{title:"登录",border:!1}},[s("van-icon",{attrs:{slot:"left",name:"cross"},on:{click:function(e){return t.$router.back()}},slot:"left"})],1),s("van-form",{ref:"loginForm",on:{submit:t.onSubmit}},[s("van-field",{attrs:{name:"mobile",placeholder:"请输入手机号",rules:t.userFormRules.mobile,type:"number",maxlength:"11"},model:{value:t.user.mobile,callback:function(e){t.$set(t.user,"mobile",e)},expression:"user.mobile"}},[s("i",{staticClass:"toutiao toutiao-shouji",attrs:{slot:"left-icon"},slot:"left-icon"})]),s("van-field",{attrs:{name:"code",placeholder:"请输入验证码",rules:t.userFormRules.code,type:"number",maxlength:"6"},scopedSlots:t._u([{key:"button",fn:function(){return[t.isCountDownShow?s("van-count-down",{staticClass:"send-sms-btn",attrs:{time:6e4,format:" ss s"},on:{finish:function(e){t.isCountDownShow=!1}}}):s("van-button",{staticClass:"send-sms-btn",attrs:{size:"small",round:"",type:"default","native-type":"button"},on:{click:t.onSendSms}},[t._v("发送验证码")])]},proxy:!0}]),model:{value:t.user.code,callback:function(e){t.$set(t.user,"code",e)},expression:"user.code"}},[s("i",{staticClass:"toutiao toutiao-yanzhengma",attrs:{slot:"left-icon"},slot:"left-icon"})]),s("div",{staticClass:"button-sub",staticStyle:{margin:"16px"}},[s("van-button",{staticClass:"login-btn",attrs:{block:"",type:"info","native-type":"submit"}},[t._v("登录")])],1)],1)],1)},o=[],a=s(6198),r=(s(8975),s(4916),s(5306),s(6165)),u={name:"LoginIndex",data:function(){return{user:{mobile:"",code:""},userFormRules:{mobile:[{required:!0,message:"手机号不能为空"},{pattern:/1[3|5|7|8|9]\d{9}/,message:"手机号格式错误"}],code:[{required:!0,message:"验证码不能为空"},{pattern:/^\d{6}$/,message:"验证码格式错误"}]},isCountDownShow:!1}},methods:{onSubmit:function(){var t=this;return(0,a.Z)(regeneratorRuntime.mark((function e(){var s,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.user,t.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),e.prev=2,e.next=5,(0,r.x4)(s);case 5:n=e.sent,o=n.data,t.$store.commit("setUser",o.data),console.log(o.data),t.$toast.success("登陆成功"),t.$router.replace(t.$route.query.path||"/my"),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](2),400===e.t0.response.status?t.$toast.fail("手机号或验证码错误"):t.$toast.fail("登录失败，稍后重试");case 16:case"end":return e.stop()}}),e,null,[[2,13]])})))()},onSendSms:function(){var t=this;return(0,a.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$refs.loginForm.validate("mobile");case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e["catch"](0),e.abrupt("return",t.$toast(e.t0.message));case 8:return t.isCountDownShow=!0,e.prev=9,e.next=12,(0,r.Q6)(t.user.mobile);case 12:t.$toast("发送成功"),e.next=19;break;case 15:e.prev=15,e.t1=e["catch"](9),t.isCountDownShow=!1,429===e.t1.response.status?t.$toast("发送过于频繁，请稍后再试"):t.$toast("发送失败，稍后重试");case 19:case"end":return e.stop()}}),e,null,[[0,5],[9,15]])})))()}}},i=u,l=s(1001),c=(0,l.Z)(i,n,o,!1,null,"76e4f160",null),m=c.exports}}]);
//# sourceMappingURL=403-legacy.2070e9d1.js.map